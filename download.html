<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Download OtoLog</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;800&family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet">
    <style>
        @keyframes pageFadeIn {
            0% { opacity: 0; transform: scale(0.98); filter: blur(10px); }
            100% { opacity: 1; transform: scale(1); filter: blur(0); }
        }
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif; margin: 0; padding: 0;
            height: 100dvh; width: 100%; overflow: hidden;
            background-image: url('bg.jpg');
            background-size: cover; background-position: center; background-repeat: no-repeat;
            color: #1d1d1f; position: relative;
            animation: pageFadeIn 0.5s cubic-bezier(0.25, 1, 0.5, 1) forwards;
        }

        .top-content {
            position: absolute; 
            /* 12% -> 8% „Å´Â§âÊõ¥„Åó„Å¶Â∞ë„Åó‰∏ä„Å´ */
            top: 8%; 
            width: 100%;
            display: flex; flex-direction: column; align-items: center;
        }
        .icon-small {
            width: 70px; height: 70px; border-radius: 18px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            margin-bottom: 15px; object-fit: cover;
        }
        h1 { font-size: 24px; font-weight: 800; margin: 0; }

        /* ‰∏≠Â§Æ„Ç´„Éº„Éâ */
        .card-wrapper {
            position: absolute; 
            /* 48% -> 42% „Å´Â§âÊõ¥„Åó„Å¶„Ç´„Éº„ÉâÂÖ®‰Ωì„Çí‰∏ä„Å´ÈÄÉ„Åå„Åô */
            top: 50%; 
            left: 50%; transform: translate(-50%, -50%);
            width: 100%; max-width: 340px; padding: 0 24px; box-sizing: border-box;
        }
        .id-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px); border-radius: 20px;
            padding: 20px; /* „Éë„Éá„Ç£„É≥„Ç∞„ÇíÂ∞ë„ÅóÊ∏õ„Çâ„Åô */
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }
        .id-label { font-size: 10px; font-weight: 700; color: #86868b; margin-bottom: 8px; }
        .id-value {
            font-size: 34px; /* ÊñáÂ≠ó„Çµ„Ç§„Ç∫„ÇíÂ∞ë„ÅóÁ∏ÆÂ∞è */
            font-weight: 800; color: #007AFF; margin-bottom: 4px; line-height: 1;
        }
        .copy-hint { font-size: 11px; color: #86868b; margin-bottom: 15px; display: block; }

        .input-guide {
            border-top: 1px dashed #ddd; padding-top: 10px; margin-top: 5px;
        }
        .guide-text { font-size: 11px; color: #333; margin-bottom: 5px; font-weight: bold; }
        
        .mock-phone {
            width: 140px; background: #E0F2F1; border-radius: 10px; padding: 8px 10px;
            margin: 0 auto; display: flex; flex-direction: column; gap: 5px; position: relative;
        }
        .mock-title { height: 6px; width: 60%; background: #00acc1; margin: 0 auto 2px; border-radius: 4px; opacity: 0.5; }
        .mock-input { height: 14px; background: white; border-radius: 4px; border: 1px solid #ddd; }
        .mock-input.target { border: 2px solid #007AFF; background: #eef6ff; }
        .pointer {
            position: absolute; right: -25px; bottom: 10px; font-size: 20px;
            animation: point 1s infinite alternate;
        }
        @keyframes point { from { transform: translateX(0); } to { transform: translateX(-5px); } }

        .bottom-area {
            position: absolute; bottom: 40px; left: 0; width: 100%;
            padding: 0 24px; box-sizing: border-box;
            display: flex; flex-direction: column; align-items: center;
        }
        .btn {
            display: flex; justify-content: center; align-items: center;
            width: 100%; max-width: 400px; height: 54px; border-radius: 14px;
            text-decoration: none; font-weight: 700; font-size: 15px;
        }
        .btn-primary { background: #1d1d1f; color: white; margin-bottom: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .btn-text { color: #007AFF; font-size: 13px; height: 40px; }
        .badge { background: #ff3b30; font-size: 10px; padding: 2px 6px; border-radius: 4px; color: white; margin-left: 6px; }
        
        .toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px);
            background: rgba(0,0,0,0.8); color: white; padding: 8px 16px; border-radius: 30px;
            font-size: 12px; opacity: 0; transition: 0.4s; pointer-events: none;
        }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
    </style>
    
</head>
<body>

    <div class="top-content">
        <img src="icon.png" class="icon-small" alt="OtoLog">
        <h1>Download</h1>
    </div>

    <div class="card-wrapper">
        <div class="id-card">
            <div class="id-label">Your Group ID</div>
            <div id="groupId" class="id-value" onclick="copyId()">...</div>
            <span class="copy-hint">„Çø„ÉÉ„Éó„Åó„Å¶„Ç≥„Éî„Éº</span>

            <div class="input-guide">
                <div class="guide-text">„Ç¢„Éó„É™„ÅÆ2ÊÆµÁõÆ„Å´ÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                <div class="mock-phone">
                    <div class="mock-title"></div>
                    <div class="mock-input"></div> <div class="mock-input target"></div> <div class="pointer">üëà</div>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-area">
        <a href="https://testflight.apple.com/join/xxxxxx" class="btn btn-primary">
            Download on iOS <span class="badge">26+</span>
        </a>
        <a href="walkthrough.html" class="btn btn-text">
            ‰Ωø„ÅÑÊñπ„Çí„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë¶ã„Çã
        </a>
    </div>

    <div id="toast" class="toast">„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü</div>

    <script>
        // ‚òÖ‚òÖ‚òÖ GAS„ÅÆURL„Å´Êõ∏„ÅçÊèõ„Åà„Å¶„Åè„Å†„Åï„ÅÑ ‚òÖ‚òÖ‚òÖ
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwaRek10Td3Z25Rfr2k6CDZ86sdtC4m5CKbDzr-59SjhJf2rpFOGyjp_Nz4xGA-GeZnPw/exec";
        
        let currentId = "";
        async function fetchId() {
            const display = document.getElementById('groupId');
            const saved = localStorage.getItem('otolog_id');
            if (saved) { currentId = saved; display.innerText = saved; return; }
            try {
                const res = await fetch(SCRIPT_URL);
                const data = await res.json();
                if (data.group === "FULL") { display.innerText = "FULL"; }
                else { currentId = data.group; display.innerText = currentId; localStorage.setItem('otolog_id', currentId); }
            } catch (e) { display.innerText = "ERR"; }
        }
        function copyId() {
            if(!currentId) return;
            navigator.clipboard.writeText(currentId).then(() => {
                const t = document.getElementById('toast');
                t.classList.add('show');
                setTimeout(() => t.classList.remove('show'), 2000);
            });
        }
        window.onload = fetchId;
    </script>
</body>
</html>
